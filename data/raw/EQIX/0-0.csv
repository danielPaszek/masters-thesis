,"Consolidated Statements of Operations - USD ($)  shares in Thousands, $ in Thousands",12 Months Ended,12 Months Ended,12 Months Ended
,"Consolidated Statements of Operations - USD ($)  shares in Thousands, $ in Thousands","Dec. 31, 2023","Dec. 31, 2022","Dec. 31, 2021"
0,Income Statement [Abstract],,,
1,Revenues,"$ 8,188,136","$ 7,263,105","$ 6,635,537"
2,Costs and operating expenses:,,,
3,Cost of revenues,4227658,3751501,3472422
4,Sales and marketing,855796,786560,741232
5,General and administrative,1654042,1498701,1301797
6,Transaction costs,12412,21839,22769
7,(Gain) loss on asset sales,"(5,046)",3976,"(10,845)"
8,Total costs and operating expenses,6744862,6062577,5527375
9,Income from operations,1443274,1200528,1108162
10,Interest income,94227,36268,2644
11,Interest expense,"(402,022)","(356,337)","(336,082)"
12,Other expense,"(11,214)","(51,417)","(50,647)"
13,Gain (loss) on debt extinguishment,(35),327,"(115,125)"
14,Income before income taxes,1124230,829369,608952
15,Income tax expense,"(155,250)","(124,792)","(109,224)"
16,Net income,968980,704577,499728
17,Net (income) loss attributable to non-controlling interests,198,(232),463
18,Net income attributable to common shareholders,"$ 969,178","$ 704,345","$ 500,191"
19,"Earnings per share (""EPS"") attributable to common shareholders:",,,
20,Basic EPS (in dollars per share),$ 10.35,$ 7.69,$ 5.57
21,Weighted-average shares for basic EPS (in shares),93615,91569,89772
22,Diluted EPS (in dollars per share),$ 10.31,$ 7.67,$ 5.53
23,Weighted-average shares for diluted EPS (in shares),94009,91828,90409
