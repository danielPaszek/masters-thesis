,"CONSOLIDATED STATEMENTS OF OPERATIONS - USD ($)  shares in Thousands, $ in Thousands",12 Months Ended,12 Months Ended,12 Months Ended
,"CONSOLIDATED STATEMENTS OF OPERATIONS - USD ($)  shares in Thousands, $ in Thousands","Dec. 31, 2020","Dec. 31, 2019","Dec. 31, 2018"
0,Revenues:,,,
1,Total revenues,"$ 2,666,702","$ 2,158,759","$ 1,881,883"
2,Costs and expenses:,,,
3,Cost of product revenues (including definite-lived intangible amortization),131328,114249,94123
4,Research and development,2215942,1154111,1197957
5,"Selling, general and administrative",516922,468711,434407
6,Change in fair value of acquisition-related contingent consideration,23385,19682,26173
7,Collaboration loss sharing,42801,,
8,Total costs and expenses,2930378,1756753,1752660
9,Income (loss) from operations,"(263,676)",402006,129223
10,"Other income (expense), net",23206,52182,31760
11,Interest expense,"(2,174)","(1,855)","(1,543)"
12,Unrealized gain (loss) on long term investments,10426,34458,"(44,093)"
13,Income (loss) before provision for income taxes,"(232,218)",486791,115347
14,Provision for income taxes,63479,39885,5854
15,Net (loss) income,"$ (295,697)","$ 446,906","$ 109,493"
16,Net income (loss) per share:,,,
17,Basic,$ (1.36),$ 2.08,$ 0.52
18,Diluted,$ (1.36),$ 2.05,$ 0.51
19,Shares used in computing net income (loss) per share:,,,
20,Basic,218073,214913,212383
21,Diluted,218073,217657,215635
22,"Product revenues, net",,,
23,Revenues:,,,
24,Total revenues,"$ 2,068,736","$ 1,774,922","$ 1,466,900"
25,Product royalty revenues,,,
26,Revenues:,,,
27,Total revenues,392966,306337,234780
28,Milestone and contract revenues,,,
29,Revenues:,,,
30,Total revenues,"$ 205,000","$ 77,500",180000
31,Other revenues,,,
32,Revenues:,,,
33,Total revenues,,,$ 203
