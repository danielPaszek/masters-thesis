,"CONSOLIDATED STATEMENTS OF OPERATIONS - USD ($)  shares in Thousands, $ in Thousands",12 Months Ended,12 Months Ended,12 Months Ended
,"CONSOLIDATED STATEMENTS OF OPERATIONS - USD ($)  shares in Thousands, $ in Thousands","Dec. 31, 2016","Dec. 31, 2015","Dec. 31, 2014"
0,Revenues:,,,
1,"Product revenues, net","$ 882,404","$ 601,015","$ 357,562"
2,Product royalty revenues,110711,74821,48966
3,Contract revenues,112512,77857,104857
4,Other revenues,92,58,110
5,Total revenues,1105719,753751,511495
6,Costs and expenses:,,,
7,Cost of product revenues (including definite-lived intangible amortization),58187,26972,3004
8,Research and development,581861,479514,347523
9,"Selling, general and administrative",303251,196614,165772
10,Change in fair value of acquisition-related contingent consideration,17422,,
11,Total costs and expenses,960721,703100,516299
12,Income (loss) from operations,144998,50651,"(4,804)"
13,"Interest and other income, net",4412,7089,3350
14,Interest expense,"(38,745)","(45,603)","(46,828)"
15,Unrealized loss on long term investment,"(3,261)","(4,581)",
16,Debt exchange expense on senior note conversions,,,(265)
17,Income (loss) before provision for income taxes,107404,7556,"(48,547)"
18,Provision (benefit) for income taxes,3182,1025,(66)
19,Net income (loss),"$ 104,222","$ 6,531","$ (48,481)"
20,Net income (loss) per share:,,,
21,Basic,$ 0.55,$ 0.04,$ (0.29)
22,Diluted,$ 0.54,$ 0.03,$ (0.29)
23,Shares used in computing net income (loss) per share:,,,
24,Basic,187873,179601,167947
25,Diluted,194125,187302,167947
