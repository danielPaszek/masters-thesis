,"CONSOLIDATED STATEMENTS OF OPERATIONS - USD ($)  shares in Thousands, $ in Thousands",12 Months Ended,12 Months Ended,12 Months Ended
,"CONSOLIDATED STATEMENTS OF OPERATIONS - USD ($)  shares in Thousands, $ in Thousands","Dec. 31, 2019","Dec. 31, 2018","Dec. 31, 2017"
0,Revenues:,,,
1,Total revenues,"$ 2,158,759","$ 1,881,883","$ 1,536,216"
2,Costs and expenses:,,,
3,Cost of product revenues (including definite-lived intangible amortization),114249,94123,79479
4,Research and development,1154111,1197957,1326134
5,"Selling, general and administrative",468711,434407,366286
6,Change in fair value of acquisition-related contingent consideration,19682,26173,7704
7,Total costs and expenses,1756753,1752660,1779603
8,Income (loss) from operations,402006,129223,"(243,387)"
9,"Other income (expense), net",52182,31760,17153
10,Interest expense,"(1,855)","(1,543)","(6,900)"
11,Unrealized gain (loss) on long term investments,34458,"(44,093)","(24,275)"
12,Expense related to senior note conversions,,,"(54,881)"
13,Income (loss) before provision for income taxes,486791,115347,"(312,290)"
14,Provision for income taxes,39885,5854,852
15,Net income (loss),"$ 446,906","$ 109,493","$ (313,142)"
16,Net income (loss) per share:,,,
17,Basic,$ 2.08,$ 0.52,$ (1.53)
18,Diluted,$ 2.05,$ 0.51,$ (1.53)
19,Shares used in computing net income (loss) per share:,,,
20,Basic,214913,212383,204580
21,Diluted,217657,215635,204580
22,"Product revenues, net",,,
23,Revenues:,,,
24,Total revenues,"$ 1,774,922","$ 1,466,900","$ 1,200,312"
25,Product royalty revenues,,,
26,Revenues:,,,
27,Total revenues,306337,234780,160791
28,Milestone and contract revenues,,,
29,Revenues:,,,
30,Total revenues,"$ 77,500",180000,175000
31,Other revenues,,,
32,Revenues:,,,
33,Total revenues,,$ 203,$ 113
