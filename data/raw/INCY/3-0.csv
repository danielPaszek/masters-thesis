,"CONSOLIDATED STATEMENTS OF OPERATIONS - USD ($)  shares in Thousands, $ in Thousands",12 Months Ended,12 Months Ended,12 Months Ended
,"CONSOLIDATED STATEMENTS OF OPERATIONS - USD ($)  shares in Thousands, $ in Thousands","Dec. 31, 2021","Dec. 31, 2020","Dec. 31, 2019"
0,Revenues:,,,
1,Total revenues,"$ 2,986,267","$ 2,666,702","$ 2,158,759"
2,Costs and expenses:,,,
3,Cost of product revenues (including definite-lived intangible amortization),150991,131328,114249
4,Research and development,1458179,2215942,1154111
5,"Selling, general and administrative",739560,516922,468711
6,Change in fair value of acquisition-related contingent consideration,14741,23385,19682
7,Collaboration loss sharing,37019,42801,
8,Total costs and expenses,2400490,2930378,1756753
9,Income (loss) from operations,585777,"(263,676)",402006
10,"Other income (expense), net",10647,23206,52182
11,Interest expense,"(1,908)","(2,174)","(1,855)"
12,Unrealized (loss) gain on long term investments,"(24,072)",10426,34458
13,Income (loss) before (benefit) provision for income taxes,570444,"(232,218)",486791
14,(Benefit) provision for income taxes,"(378,137)",63479,39885
15,Net income (loss),"$ 948,581","$ (295,697)","$ 446,906"
16,Net income (loss) per share:,,,
17,Basic,$ 4.30,$ (1.36),$ 2.08
18,Diluted,$ 4.27,$ (1.36),$ 2.05
19,Shares used in computing net income (loss) per share:,,,
20,Basic,220428,218073,214913
21,Diluted,222074,218073,217657
22,"Product revenues, net",,,
23,Revenues:,,,
24,Total revenues,"$ 2,322,012","$ 2,068,736","$ 1,774,922"
25,Product royalty revenues,,,
26,Revenues:,,,
27,Total revenues,569255,392966,306337
28,Milestone and contract revenues,,,
29,Revenues:,,,
30,Total revenues,"$ 95,000","$ 205,000","$ 77,500"
